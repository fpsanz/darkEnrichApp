---
title: "RNAseq enrichment report"
author: ""
date: "`r format(Sys.time(), '%d %B %Y')`"
output:
  rmdformats::readthedown:
    highlight: kate
params:
  tempdir: NA
  pcaObj: NA
  rlog: NA
  colorespca: NA
  variables: NA
  samplename: NA
  boxObj: NA
  vsd: NA
  boxplotswitch: NA
---


```{r results="asis", echo=FALSE}
cat("
<style>
#content {
  max-width: 1080px;
  margin-left: 300px;
  background: #edf0f2;
}
</style>
")
```

```{r setup, echo=FALSE, include=FALSE, comment=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, fig.width = 12)
setwd(params$tempdir)
library("scales")
library("shinydashboard")
library("limma")
library("tidyverse")
library("DT")
library("purrr")
library("plotly")
library("DESeq2")
library("ggraph")
library("igraph")
library("edgeR")
library("PoiClaClu")
library("ggplot2")
library("pheatmap")
library("RColorBrewer")
library("knitr")
library("apeglm")
library("calibrate")
library("AnnotationDbi")
library('org.Mm.eg.db')
library('AnnotationHub')
library('plotly')
library('topGO')
library('Rgraphviz')
library("BiocParallel")
library('clusterProfiler')
library('pathview')
library('gage')
library('ggpubr')
library('gageData')
library('EnsDb.Mmusculus.v79')
library('EnhancedVolcano')
library('gplots')
source("utils.R")

# dds <- readRDS("tmpResources/deseq.Rds")
# 
# genesUp <- readRDS("tmpResources/genesUp.Rds")
# genesDown <- readRDS("tmpResources/genesDown.Rds")
# 
# #genesAll <- readRDS()
# 
# kggUp <- readRDS("tmpResources/kggUp.Rds")
# kggDTup <- readRDS("tmpResources/kggDTup.Rds")
# kggDown <- readRDS("tmpResources/kggDown.Rds")
# kggDTdown <- readRDS("tmpResources/kggDTdown.Rds")
# 
# #kggDTAll <- readRDS()
# 
# goUp <- readRDS("tmpResources/goUp.Rds")
# goDTup <- readRDS("tmpResources/goDTup.Rds")
# goDown <- readRDS("tmpResources/goDown.Rds")
# goDTdown <- readRDS("tmpResources/goDTdown.Rds")
# 
# #goDTAll <- readRDS()
# 
# gsea <- readRDS("tmpResources/gsea.Rds")

```

```{r previewTitle, eval=params$pcaObj, results='asis'}
cat("# Preview section")
```

```{r, pcatitle, eval = params$pcaObj, results='asis'}
cat("## PCA 2D")
```


```{r , pca2d, eval=params$pcaObj}
    plotPCA(
        params$rlog,
        intgroup = params$variables,
        labels = params$samplename,
        customColor = params$colorespca
    ) +
        theme(plot.margin = unit(c(0.5, 0.5, 0.5, 0.5), "cm")) +
        scale_size_manual(values = 3) +
        theme(text = element_text(size = 16))
```

```{r boxplotitle, eval=params$boxObj, results='asis' }
cat("## Box/Violin plot")
```

```{r boxplot, eval=params$boxObj }
boxViolin( names = params$samplename , vsd=params$vsd, boxplotswitch=params$boxplotswitch,
                    intgroup=params$variables, customColor = params$colorespca ) 
```

